<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Who am I? - The Opt Out Project</title><meta name="description" content="I left Google in March of 2012, Facebook in early 2016. In 2014 I went viral for keeping a pregnancy&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://cyberlyra.github.io/cyberlyra/who-am-i/"><link rel="alternate" type="application/atom+xml" href="https://cyberlyra.github.io/cyberlyra/feed.xml"><link rel="alternate" type="application/json" href="https://cyberlyra.github.io/cyberlyra/feed.json"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@cyberlyra"><meta name="twitter:title" content="Who am I?"><meta name="twitter:description" content="I left Google in March of 2012, Facebook in early 2016. In 2014 I went viral for keeping a pregnancy&hellip;"><meta name="twitter:image" content="https://cyberlyra.github.io/cyberlyra/media/posts/13/tweet.png"><link rel="preload" href="https://cyberlyra.github.io/cyberlyra/assets/dynamic/fonts/andadapro/andadapro.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://cyberlyra.github.io/cyberlyra/assets/dynamic/fonts/petrona/petrona.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://cyberlyra.github.io/cyberlyra/assets/css/style.css?v=c502451c9689534bb6a35a9e6baccfa7"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://cyberlyra.github.io/cyberlyra/who-am-i/"},"headline":"Who am I?","datePublished":"2022-09-28T13:48","dateModified":"2022-10-04T12:51","image":{"@type":"ImageObject","url":"https://cyberlyra.github.io/cyberlyra/media/posts/13/tweet.png","height":400,"width":400},"description":"I left Google in March of 2012, Facebook in early 2016. In 2014 I went viral for keeping a pregnancy&hellip;","author":{"@type":"Person","name":"Janet Vertesi","url":"https://cyberlyra.github.io/cyberlyra/authors/janet-vertesi/"},"publisher":{"@type":"Organization","name":"Janet Vertesi"}}</script></head><body><header class="header" id="js-header"><a href="https://cyberlyra.github.io/cyberlyra/" class="logo">The Opt Out Project</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li class="has-submenu"><a href="https://cyberlyra.github.io/cyberlyra/this-is-a-first-post-title/" title="Opt Out Basics" target="_self" aria-haspopup="true">Welcome</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://cyberlyra.github.io/cyberlyra/this-is-a-first-post-title-2/" target="_self">About the Opt Out Project</a></li></ul></li><li class="has-submenu"><a href="https://cyberlyra.github.io/cyberlyra/tags/the-basics/" target="_self" aria-haspopup="true">How To</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://cyberlyra.github.io/cyberlyra/tags/the-basics/" target="_self">Opt Out Toolkit</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/the-best-non-google-search-engine/" target="_self">Leave Google</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/homesteading/" target="_self">Digital Homesteading</a></li></ul></li><li class="has-submenu"><a href="https://cyberlyra.github.io/cyberlyra/tags/reviews/" title="Reviews" target="_self" aria-haspopup="true">Reviews</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://cyberlyra.github.io/cyberlyra/tags/phones/" target="_self">Phones</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/everyday-apps/" target="_self">Everyday Apps</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/email/" target="_self">Email</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/search/" target="_self">Search</a></li></ul></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/the-tools/" target="_self">Philosophy</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/deep-game/" target="_self">Stories</a></li><li><a href="https://buttondown.email/optoutproject" target="_self">Subscribe</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://cyberlyra.github.io/cyberlyra/tags/basics/" class="post__maintag">Basics</a><h1 class="post__title">Who am I?</h1><div class="post__meta"><time datetime="2022-09-28T13:48">September 28, 2022</time></div></header><figure class="post__featured-image"><img src="https://cyberlyra.github.io/cyberlyra/media/posts/13/tweet.png" srcset="https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/tweet-xs.png 300w, https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/tweet-sm.png 480w, https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/tweet-md.png 768w, https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/tweet-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="400" width="400" alt=""><figcaption>This is me, circa 2021.</figcaption></figure><div class="post__inner"><div class="post__entry"><p>I left Google in March of 2012, Facebook in early 2016. In 2014 I went viral for keeping a pregnancy away from detection online. I still buy everything related to my children untraceably.  In my spare time I hack cell phones.</p><p>Why do all this?</p><p>I'm an expert in the relationship between technology and society. I'm a professor at Princeton University in the Sociology department, where I'm affiliated with Computer Science, the Center for Digital Humanities, and the Center for Information Technology Policy. I have a PhD in the study of science, technology, and society, which is actually a field. I research NASA's robotic spacecraft teams, studying how they work together and sometimes assisting them in organizing their teams for success.  I also publish in Human-Computer Interaction, alongside computer scientists.</p><p>It's this expertise that drove me to what I now call the Opt Out Experiments.</p><p>I've always been into computers. My dad brought our first one home in 1984, and I was hooked.  I had a reputation for being a computer geek and an early adopter. I even study robots in space!</p><p>But things changed once tech companies discovered they could mine user data for advertisting. Despite study after study showing the perilous road that Silicon Valley was on, companies refused to change their path, and people kept logging in. </p><p>Algorithmic recommenders. Filter bubbles. Predictive policing. Biased datasets. Manipulation. Persuasive design. All of it fueling and fueled by a rampant collection of personal data.</p><p>I was there as this was being developed and rolled out, and I saw the writing on the wall. Anyone with my training could see the technological dystopia we're currently enduring, coming from a mile away.</p><p>That didn't stop Silicon Valley from trampling all over those hard-won lessons from the history and sociology of technology. Maybe they thought we were just naysayers or Luddites instead of experts? As a result, people are still blissfully clicking and scrolling, and in so many predictable ways, the fabric of our society is fraying under the strain.</p><p>Amid all the heady rhetoric from Sillly Valley, it's easy to forget that technologies aren't some meteorite from outer space that hit "society," transforming it from out of nowhere (trust me, I study NASA, it's not that easy). Technologies are tools we build, along the lines of our choosing. The everyday devices in our pockets and on our desktops that are torquing our social world are just one vision among endless alternative possibilities. It could always be otherwise.</p><p>It still can. <span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">T</span>here are lots of ways to make digital devices, systems, and services <em>work</em>. Possibilities imbued with data stewardship and personal privacy. Tools that bring us a better, more harmonious, social world.  We can<span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);"> choose--and build--differently.</span></p><p><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);">That's why I started opting out.  </span>I have spent the last decade ditching toxic technologies, avoiding Big Tech's venomous tendrils like the plague. I did it all without living in a cave, throwing my devices away, or becoming a Luddite. I'm online, and my life is suffused with technologies. But I choose thoughtfully, ethically and responsibly. I'm not interested in if the latest blingy device comes in rose gold. Instead, I embrace companies and communities who help me to keep my data private, and to steer clear of those who don't. Sometimes I build things myself so that I know exactly where my data is.</p><figure><figure class="post__image post__image--left"><img loading="lazy" src="https://cyberlyra.github.io/cyberlyra/media/posts/13/IMG_5374.JPG" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/IMG_5374-xs.JPG 300w, https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/IMG_5374-sm.JPG 480w, https://cyberlyra.github.io/cyberlyra/media/posts/13/responsive/IMG_5374-md.JPG 768w" alt="I have a lot of alternative, old, or hackable phones. Here are a few of them." width="400" height="300"></figure><figcaption>What do these alternative phones have in common? They all promised a less toxic future than the one we're living in.</figcaption></figure><p>Since more and more people seem to want to know what I do and how to follow along, I started this site. I'll review some of my favorite tools and alternative options for you to consider. I'll share tips for how I manage my data in the face of an Internet hellbent on its lucrative extraction. I'll occasionally muse about what I've learned about Internet privacy while opting out. You can follow along online, and sign up for my mailing list to learn about fresh posts and ideas.</p><p>The opinions expressed here are entirely my own. I'm not paid for reviews of products, I'm just telling you what works for me. I'm not a journalist; I'm an academic, but I'll make every effort to make this readable. Also, since I'm all about data privacy and ownership, nothing on this website is stealing your data. You can browse, read, and subscribe in peace.</p><p>It's time for change. Techlash is rampant, people are angry at the FAANGs and tired of the Metaverse, Crypto, and the "next big thing." Fortunately, the power is in our hands. We can, truly can, leave these systems behind in the dirt. We can put our eggs in a better basket than this.</p><p>Let's get started.</p><p> </p></div><footer><div class="post__tags-share"><ul class="post__tag"><li><a href="https://cyberlyra.github.io/cyberlyra/tags/basics/">Basics</a></li><li><a href="https://cyberlyra.github.io/cyberlyra/tags/the-tools/">Philosophy</a></li></ul><aside class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Fcyberlyra.github.io%2Fcyberlyra%2Fwho-am-i%2F&amp;via=%40cyberlyra&amp;text=Who%20am%20I%3F" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://cyberlyra.github.io/cyberlyra/assets/svg/svg-map.svg#twitter"/></svg></a></aside></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://cyberlyra.github.io/cyberlyra/my-privacy-policy/" rel="prev">Previous Post<h3 class="h6">My Privacy Policy</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://cyberlyra.github.io/cyberlyra/how-to-the-tech-break-up/" rel="prev">Next Post<h3 class="h6">How To: The Tech Break-Up</h3></a></div></nav></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://cyberlyra.github.io/cyberlyra/tags/basics/">Basics</a></div><h3 class="c-card__title"><a href="https://cyberlyra.github.io/cyberlyra/this-is-a-first-post-title-2/" class="invert">About the Opt Out Project</a></h3></header><footer class="c-card__meta"><time datetime="2022-10-04T12:43">October 4, 2022</time></footer></div></article><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://cyberlyra.github.io/cyberlyra/tags/basics/">Basics</a></div><h3 class="c-card__title"><a href="https://cyberlyra.github.io/cyberlyra/the-secrets-to-my-success/" class="invert">The Secrets to Success</a></h3></header><footer class="c-card__meta"><time datetime="2022-10-03T19:29">October 3, 2022</time></footer></div></article><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://cyberlyra.github.io/cyberlyra/tags/the-tools/">Philosophy</a></div><h3 class="c-card__title"><a href="https://cyberlyra.github.io/cyberlyra/my-privacy-policy/" class="invert">My Privacy Policy</a></h3></header><footer class="c-card__meta"><time datetime="2022-10-03T18:37">October 3, 2022</time></footer></div></article><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://cyberlyra.github.io/cyberlyra/tags/basics/">Basics</a></div><h3 class="c-card__title"><a href="https://cyberlyra.github.io/cyberlyra/how-to-the-tech-break-up/" class="invert">How To: The Tech Break-Up</a></h3></header><footer class="c-card__meta"><time datetime="2022-09-28T13:41">September 28, 2022</time></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="@cyberlyra" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://cyberlyra.github.io/cyberlyra/assets/svg/svg-map.svg#twitter"/></svg></a></div><div class="footer__copyright">Copyright Janet Vertesi 2022. Static HTML blog made with Publii. No cookies, no trackers.</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://cyberlyra.github.io/cyberlyra/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script>Like what you're reading? Check out my email privacy tips, grab an alias, and sign up for my newsletter!<iframe scrolling="no" style="width:100%!important;height:220px;border:1px #ccc solid !important" src="https://buttondown.email/optoutproject?as_embed=true"></iframe><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" class="pcb__title">This website HAS NO COOKIES</div><div id="pcb-txt" class="pcb__txt">This is a static HTML site with no cookies, trackers, beacons, or bots. You may browse in peace. <a href="#not-specified">Here is my privacy policy ...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Wow, great!</button></div></div></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>